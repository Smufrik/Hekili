# Shaman: Enhancement
# SimCraft 548-8 - MoP 5.4.8 Optimized

actions.precombat+=/windfury_weapon,if=!enchant.windfury.weapon
actions.precombat+=/flametongue_weapon,if=!enchant.flametongue.weapon
actions.precombat+=/lightning_shield,if=buff.lightning_shield.down
actions.precombat+=/potion,name=virmens_bite



##Opener

actions+=/bloodlust,if=target.health.pct<25|time_to_die>30
actions+=/use_items
actions+=/stormlash_totem,if=totem.stormlash_totem.down&buff.stormlash_totem.down&(buff.bloodlust.up|time_to_die>=60)
actions+=/potion,name=virmens_bite_potion,if=time>60&(pet.primal_fire_elemental.active|pet.greater_fire_elemental.active|time_to_die<=60)
actions+=/blood_fury
actions+=/arcane_torrent
actions+=/berserking
actions+=/elemental_mastery,if=talent.elemental_mastery.enabled&(talent.primal_elementalist.enabled&glyph.fire_elemental_totem.enabled&(cooldown.fire_elemental_totem.remains=0|cooldown.fire_elemental_totem.remains>=80))
actions+=/elemental_mastery,if=talent.elemental_mastery.enabled&(talent.primal_elementalist.enabled&glyph.fire_elemental_totem.disabled&(cooldown.fire_elemental_totem.remains=0|cooldown.fire_elemental_totem.remains>=50))
actions+=/elemental_mastery,if=talent.elemental_mastery.enabled&talent.primal_elementalist.disabled
actions+=/fire_elemental_totem,if=totem.fire_elemental.down
actions+=/ascendance,if=cooldown.stormstrike.remains>=3
actions+=/lifeblood,if=(glyph.fire_elemental_totem.enabled&(pet.primal_fire_elemental.active|pet.greater_fire_elemental.active))|!glyph.fire_elemental_totem.enabled
actions+=/run_action_list,name=single,if=active_enemies=1
actions+=/run_action_list,name=aoe,if=active_enemies>1

##Default Actions (Always Available)
actions+=/wind_shear,if=target.debuff.casting.react
actions+=/spiritwalkers_grace,if=moving&buff.ascendance.down
actions+=/ancestral_swiftness,if=buff.maelstrom_weapon.stack>=5


##Single Target

actions.single+=/searing_totem,if=totem.searing_totem.down&totem.fire_elemental.down
actions.single+=/unleash_elements,if=(talent.unleashed_fury.enabled|buff.tier16_4pc_enhancement.up)
actions.single+=/elemental_blast,if=talent.elemental_blast.enabled&buff.maelstrom_weapon.stack>=1
actions.single+=/lightning_bolt,if=buff.maelstrom_weapon.stack=5
actions.single+=/feral_spirit,if=buff.tier15_4pc_enhancement.up
actions.single+=/stormblast,if=buff.ascendance.up
actions.single+=/stormstrike,if=buff.ascendance.down
actions.single+=/lava_lash,if=buff.ascendance.up
actions.single+=/flame_shock,if=buff.unleash_flame.up&!dot.flame_shock.ticking
actions.single+=/lava_lash,if=buff.ascendance.down
actions.single+=/lightning_bolt,if=buff.tier15_2pc_enhancement.up&buff.maelstrom_weapon.stack>=4&buff.ascendance.down
actions.single+=/flame_shock,if=buff.unleash_flame.up|!dot.flame_shock.ticking
actions.single+=/unleash_elements,if=buff.ascendance.down
actions.single+=/frost_shock,if=glyph.frost_shock.enabled&buff.tier14_4pc_enhancement.down
actions.single+=/lightning_bolt,if=buff.maelstrom_weapon.stack>=3&buff.ascendance.down
actions.single+=/ancestral_swiftness,if=talent.ancestral_swiftness.enabled&buff.maelstrom_weapon.stack<2
actions.single+=/lightning_bolt,if=buff.ancestral_swiftness.up
actions.single+=/earth_shock,if=(glyph.frost_shock.disabled|buff.tier14_4pc_enhancement.up)&buff.ascendance.down
actions.single+=/feral_spirit,if=buff.ascendance.down
actions.single+=/earth_elemental_totem,if=totem.earth_elemental.down&buff.ascendance.down
actions.single+=/spiritwalkers_grace,if=moving&buff.ascendance.down
actions.single+=/lightning_bolt,if=buff.maelstrom_weapon.stack>1&buff.ascendance.down


##AoE

actions.aoe+=/fire_nova,if=active_dot.flame_shock>=4
actions.aoe+=/wait,sec=cooldown.fire_nova.remains,if=active_dot.flame_shock>=4&cooldown.fire_nova.remains<0.67
actions.aoe+=/magma_totem,if=active_enemies>5&totem.magma_totem.down&totem.fire_elemental.down&totem.searing_totem.down
actions.aoe+=/searing_totem,if=active_enemies<=5&totem.searing_totem.down&totem.fire_elemental.down&totem.magma_totem.down
actions.aoe+=/lava_lash,if=dot.flame_shock.ticking&buff.ascendance.up
actions.aoe+=/elemental_blast,if=talent.elemental_blast.enabled&buff.maelstrom_weapon.stack>=1
actions.aoe+=/chain_lightning,if=active_enemies>=2&buff.maelstrom_weapon.stack>=3
actions.aoe+=/unleash_elements,if=buff.ascendance.down
actions.aoe+=/flame_shock,cycle_targets=1,if=!dot.flame_shock.ticking
actions.aoe+=/stormblast,if=buff.ascendance.up
actions.aoe+=/lava_lash,if=dot.flame_shock.ticking&buff.ascendance.down
actions.aoe+=/fire_nova,if=active_dot.flame_shock>=3
actions.aoe+=/chain_lightning,if=active_enemies>=2&buff.maelstrom_weapon.stack>=1&buff.ascendance.down
actions.aoe+=/stormstrike,if=buff.ascendance.down
actions.aoe+=/earth_shock,if=active_enemies<4&buff.ascendance.down
actions.aoe+=/feral_spirit,if=buff.ascendance.down
actions.aoe+=/earth_elemental_totem,if=totem.earth_elemental.down&cooldown.fire_elemental_totem.remains>=50&buff.ascendance.down
actions.aoe+=/spiritwalkers_grace,if=moving&buff.ascendance.down
actions.aoe+=/fire_nova,if=active_dot.flame_shock>=1
